<!DOCTYPE html>
<html lang="bn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>MRDS Ultimate v6.2 - Auto Login</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>
    
    <style>
        /* --- THEME & CSS (পূর্বের মতই রাখা হয়েছে) --- */
        :root {
            --primary: #4f46e5; --primary-dark: #3730a3;
            --bg: #f3f4f6; --surface: #ffffff; --text: #1f2937; --text-light: #6b7280;
            --border: #e5e7eb; --radius: 12px;
            --shadow: 0 4px 6px -1px rgba(0,0,0,0.05);
        }
        * { box-sizing: border-box; margin: 0; padding: 0; font-family: 'Segoe UI', sans-serif; -webkit-tap-highlight-color: transparent; }
        body { background: var(--bg); color: var(--text); padding-bottom: 80px; font-size: 15px; }
        .hidden { display: none !important; }
        .flex { display: flex; align-items: center; }
        .flex-between { justify-content: space-between; }
        .card { background: var(--surface); padding: 16px; border-radius: var(--radius); box-shadow: var(--shadow); margin-bottom: 12px; border: 1px solid var(--border); }
        .btn { background: var(--primary); color: white; border: none; padding: 12px; border-radius: 8px; font-weight: 600; cursor: pointer; display: flex; justify-content: center; align-items: center; gap: 8px; width: 100%; transition: 0.2s; }
        .navbar { position: sticky; top: 0; background: var(--surface); padding: 10px 16px; border-bottom: 1px solid var(--border); z-index: 100; display: flex; justify-content: space-between; align-items: center; }
        .bottom-nav { position: fixed; bottom: 0; left: 0; width: 100%; background: var(--surface); border-top: 1px solid var(--border); display: flex; justify-content: space-around; padding: 8px 0; z-index: 1000; }
        .nav-item { background: none; border: none; color: var(--text-light); font-size: 0.7rem; display: flex; flex-direction: column; align-items: center; gap: 4px; flex: 1; }
        .nav-item.active { color: var(--primary); font-weight: 700; }
        .marquee-container { background: var(--primary); color: white; overflow: hidden; white-space: nowrap; height: 35px; display: flex; align-items: center; }
        .marquee-content { display: inline-block; padding-left: 100%; animation: scroll 20s linear infinite; }
        @keyframes scroll { 0% { transform: translateX(0); } 100% { transform: translateX(-100%); } }
    </style>
</head>
<body>

    <div id="loadingScreen" style="position: fixed; inset: 0; background: var(--primary); display: flex; flex-direction: column; justify-content: center; align-items: center; color: white; z-index: 5000;">
        <i class="fas fa-meteor fa-spin" style="font-size: 3rem; margin-bottom: 20px;"></i>
        <h2>MRDS v6.2</h2>
        <p>অটোমেটিক লগইন হচ্ছে...</p>
    </div>

    <div id="app" class="hidden">
        <nav class="navbar">
            <div class="nav-brand"><i class="fas fa-book-reader"></i> <span id="headerTitle">হোম</span></div>
            <div class="flex gap-3 items-center">
                <div class="text-right" style="margin-right: 10px;">
                    <div class="text-xs text-light" id="navName">User</div>
                    <div class="text-sm font-bold text-success" id="navBal">৳0</div>
                </div>
                <img src="" id="navAvatar" style="width:35px; height:35px; border-radius:50%; object-fit:cover;" onerror="this.src='https://via.placeholder.com/35'">
            </div>
        </nav>

        <div class="marquee-container">
            <div class="marquee-content" id="marqueeText">স্বাগতম! ডাটা লোড হচ্ছে...</div>
        </div>

        <div class="p-4" style="padding: 15px;">
            <div id="view-home" class="view">
                <div class="card" style="border-left: 4px solid #f59e0b;">
                    <b class="text-primary">হ্যালির ধূমকেতু অফিসিয়াল ব্লগ</b>
                    <p class="text-xs text-light">সরাসরি অ্যাপ থেকে আপডেট পান।</p>
                </div>
                <h4 class="mb-2"><i class="fas fa-rss"></i> নিউজফিড</h4>
                <div id="postsContainer">লুডিং পোস্ট...</div>
            </div>
            
            <div id="view-exam" class="view hidden"><h4>চলমান এক্সাম</h4><div id="examList"></div></div>
            <div id="view-wallet" class="view hidden">
                <div class="card text-center" style="background: linear-gradient(135deg, #4338ca, #6366f1); color: white; padding: 20px;">
                    <p>ব্যালেন্স</p>
                    <h1 id="walletBigBal">৳0</h1>
                </div>
            </div>
        </div>

        <div class="bottom-nav">
            <button class="nav-item active" onclick="nav('home', this)"><i class="fas fa-home"></i> হোম</button>
            <button class="nav-item" onclick="nav('exam', this)"><i class="fas fa-clipboard-check"></i> এক্সাম</button>
            <button class="nav-item" onclick="nav('wallet', this)"><i class="fas fa-wallet"></i> ওয়ালেট</button>
        </div>
    </div>

    <script>
        const firebaseConfig = {
            apiKey: "AIzaSyBC9hwiWQS0rPMyvj3XVPdpExB1RSyQi1E",
            authDomain: "myblogapp-8e9e5cc8.firebaseapp.com",
            databaseURL: "https://myblogapp-8e9e5cc8-default-rtdb.firebaseio.com/",
            projectId: "myblogapp-8e9e5cc8",
            storageBucket: "myblogapp-8e9e5cc8.firebasestorage.app",
            messagingSenderId: "995232144893",
            appId: "1:995232144893:web:9ca49253831a0e06404d94"
        };

        firebase.initializeApp(firebaseConfig);
        const db = firebase.database();

        // অটো লগইন করার জন্য মোবাইল নম্বর (আপনার ডাটাবেসে থাকা নম্বর দিন)
        const DEFAULT_USER_ID = "01700000000"; 
        let CURR_USER = null;

        // অ্যাপ শুরু হওয়ার ফাংশন
        async function initApp() {
            try {
                const snapshot = await db.ref('users/' + DEFAULT_USER_ID).once('value');
                const userData = snapshot.val();

                if (userData) {
                    CURR_USER = { id: DEFAULT_USER_ID, ...userData };
                    updateUI();
                    loadPosts();
                    loadNotice();
                    
                    // লোডিং স্ক্রিন সরিয়ে অ্যাপ দেখানো
                    document.getElementById('loadingScreen').classList.add('hidden');
                    document.getElementById('app').classList.remove('hidden');
                } else {
                    alert("ইউজার পাওয়া যায়নি! ডাটাবেসে ০১৭০০০০০০০০ নম্বরটি আছে কিনা চেক করুন।");
                }
            } catch (error) {
                console.error(error);
                alert("Database Connection Error!");
            }
        }

        function updateUI() {
            document.getElementById('navName').innerText = CURR_USER.name;
            document.getElementById('navBal').innerText = "৳" + CURR_USER.bal;
            document.getElementById('walletBigBal').innerText = "৳" + CURR_USER.bal;
            if(CURR_USER.avatar) document.getElementById('navAvatar').src = CURR_USER.avatar;
        }

        async function loadPosts() {
            const snap = await db.ref('posts').limitToLast(10).once('value');
            const posts = snap.val();
            let html = '';
            for(let id in posts) {
                const p = posts[id];
                html += `<div class="card">
                    <b>${p.t}</b>
                    <p style="font-size:0.9rem; margin-top:5px;">${p.c}</p>
                    ${p.img ? `<img src="${p.img}" style="width:100%; border-radius:8px; margin-top:10px;">` : ''}
                </div>`;
            }
            document.getElementById('postsContainer').innerHTML = html;
        }

        async function loadNotice() {
            const snap = await db.ref('notice').once('value');
            if(snap.val()) document.getElementById('marqueeText').innerText = snap.val();
        }

        function nav(viewId, btn) {
            document.querySelectorAll('.view').forEach(v => v.classList.add('hidden'));
            document.getElementById('view-' + viewId).classList.remove('hidden');
            document.querySelectorAll('.nav-item').forEach(i => i.classList.remove('active'));
            btn.classList.add('active');
            document.getElementById('headerTitle').innerText = viewId.toUpperCase();
        }

        // রান অ্যাপ
        initApp();
    </script>
</body>
</html>
